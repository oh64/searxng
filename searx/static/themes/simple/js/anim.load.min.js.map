{"version":3,"file":"anim.load.min.js","names":["enginesCache: EnginesCache","interval: number | null"],"sources":["../../../../../client/simple/src/js/main/anim.load.ts"],"sourcesContent":["// SPDX-License-Identifier: AGPL-3.0-or-later\n\nexport interface EnginesCache {\n  [category: string]: string[];\n}\n\n(async () => {\n  const form = document.querySelector<HTMLFormElement>('form#search');\n  const overlay = document.getElementById('loading_overlay');\n  const loadingText = document.getElementById('loading_text');\n  let enginesCache: EnginesCache = {};\n  let index = 0;\n  let interval: number | null = null;\n\n  if (!form || !overlay) return;\n\n  try {\n    const response = await fetch('/engines.json');\n    enginesCache = await response.json();\n  } catch (err) {\n    console.error('Error engines.json not fetched', err);\n    enginesCache = {};\n  }\n\n  form.addEventListener('submit', () => {\n    const formData = new FormData(form);\n    if (formData.get('q') != '') {\n      const catValue = String(formData.get('categories') || formData.get('category_general') || '');\n      const category = (catValue === \"1\" || catValue === \"general\") ? \"web\" : (catValue || \"web\");\n\n      overlay.style.display = 'flex';\n      index = 0;\n\n      const engines = enginesCache[String(category)] || [\"the web\"];\n\n      interval = window.setInterval(() => {\n        if (index < engines.length) {\n          if (loadingText) loadingText.textContent = `Searching on ${engines[index]}...`;\n          index++;\n        } else {\n          if (loadingText) loadingText.textContent = `Finalizing the ${category} search...`;\n          clearInterval(interval!);\n          interval = null;\n        }\n      }, 500);\n    }\n  });\n\n  window.addEventListener('pageshow', () => {\n    if (interval !== null) {\n      clearInterval(interval);\n      interval = null;\n    }\n    if (overlay) overlay.style.display = 'none';\n  });\n})();\n"],"mappings":"CAMC,SAAY,CACX,IAAM,EAAO,SAAS,cAA+B,cAAc,CAC7D,EAAU,SAAS,eAAe,kBAAkB,CACpD,EAAc,SAAS,eAAe,eAAe,CACvDA,EAA6B,CAAE,EAC/B,EAAQ,EACRC,EAA0B,KAE1B,MAAC,GAAQ,CAAC,GAEd,IAAI,CACF,IAAM,EAAW,MAAM,MAAM,gBAAgB,CAC7C,EAAe,MAAM,EAAS,MAAM,AACrC,OAAQ,EAAK,CACZ,QAAQ,MAAM,iCAAkC,EAAI,CACpD,EAAe,CAAE,CAClB,CAED,EAAK,iBAAiB,SAAU,IAAM,CACpC,IAAM,EAAW,IAAI,SAAS,GAC9B,GAAI,EAAS,IAAI,IAAI,EAAI,GAAI,CAC3B,IAAM,EAAW,OAAO,EAAS,IAAI,aAAa,EAAI,EAAS,IAAI,mBAAmB,EAAI,GAAG,CACvF,EAAY,IAAa,KAAO,IAAa,UAAa,MAAS,GAAY,MAErF,EAAQ,MAAM,QAAU,OACxB,EAAQ,EAER,IAAM,EAAU,EAAa,OAAO,EAAS,GAAK,CAAC,SAAU,EAE7D,EAAW,OAAO,YAAY,IAAM,CAC9B,EAAQ,EAAQ,QACd,IAAa,EAAY,YAAc,CAAC,aAAa,EAAE,EAAQ,GAAO,GAAG,CAAC,EAC9E,MAEI,IAAa,EAAY,YAAc,CAAC,eAAe,EAAE,EAAS,UAAU,CAAC,EACjF,cAAc,EAAU,CACxB,EAAW,KAEd,EAAE,IAAI,AACR,CACF,EAAC,CAEF,OAAO,iBAAiB,WAAY,IAAM,CACpC,IAAa,OACf,cAAc,EAAS,CACvB,EAAW,MAET,IAAS,EAAQ,MAAM,QAAU,OACtC,EAAC,AAhCD,CAiCF,IAAG"}